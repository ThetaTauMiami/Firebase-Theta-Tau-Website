<script type="module">
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js";
    import { auth } from "/config/firebaseConfig.js";

    console.log("Auth script loaded");

    function applyAuthState() {
        const whenSignedOutNav = document.getElementById("whenSignedOutNav");
        const whenSignedInNav = document.getElementById("whenSignedInNav");

        if (!whenSignedOutNav || !whenSignedInNav) {
            console.error("Navbar elements not found!");
            return;
        }

        console.log("Checking authentication state...");

        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log("User is logged in:", user.uid);
                whenSignedOutNav.style.display = "none";
                whenSignedInNav.style.display = "block";
            } else {
                console.log("User is not logged in");
                whenSignedOutNav.style.display = "block";
                whenSignedInNav.style.display = "none";
            }
        });
    }

    // Wait for the DOM and all elements to be fully loaded
    window.addEventListener("load", applyAuthState);
</script>


<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button class="navbar-toggle" data-target="#myNavbar"
                    data-toggle="collapse" type="button">
                <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
            </button> <a class="navbar-brand" href="/public"><span id="nav">THETA TAU | <span class="hidden-xs hidden-sm">MIAMI UNIVERSITY</span><span class="hidden-md hidden-lg hidden-xl">ΤΔ</span></span></a>
            <span class="hidden-xs hidden-sm"><a href="/public"><img src="assets/img/login-logo.png" class="navbar-brand"></a></span>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="index.html">HOME</a>
                </li>
                <li>
                    <a href="gallery.html">GALLERY</a>
                </li>
                <li>
                    <a href="events.html">EVENTS</a>
                </li>
                <li>
                    <a href="leadership.html">LEADERSHIP</a>
                </li>
                <li>
                    <a href="recruitment.html">RECRUITMENT</a>
                </li>
                <!--
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">MEMBERS
                        <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="/members">ACTIVES</a></li>
                        <li><a href="/alumni">ALUMNI</a></li>
                        <li><a href="/resumes">MEMBER RESUMES</a></li>
                    </ul>
                </li>
                -->
                <li>
                    <a href="contact.html">CONTACT</a>
                </li>
                <!-- The login tab, which connects to Firebase to become the User Account page. *** ONLY appears when the user is not logged in -->
                <li id="whenSignedOutNav">
                    <a href="login.html" >LOGIN</a>
                </li>
                <!--This section only appears to change the name of the LOGIN tab for the users signed in to view their accounts-->
                <li id="whenSignedInNav" style="display:none;">
                    <a href="account.html">ACCOUNT</a>
                </li>
            </ul>
        </div>
    </div>
</nav>


